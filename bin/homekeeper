#!/usr/bin/env python2
import os
import sys

import homekeeper


def print_usage():
    print 'homekeeper 2.0.0 by Min Huang (min.huang@alumni.usc.edu)'
    print ''
    print 'Usage: homekeeper <command>'
    print ''
    print '<commands>'
    print '  link    symlink dotfiles to home directory'
    print '  save    save last commit to master branch'
    print '  track   track a dotfile with homekeeper'
    print '  update  update dotfiles from git'

def parse_config():
    pathname = os.path.join(os.getenv('HOME'), '.homekeeper.conf')
    if not os.path.exists(pathname):
        print 'please create ~/.homekeeper.conf'
        sys.exit(1)
    config = {}
    execfile(pathname, config)
    return config

config = parse_config()
h = homekeeper.Homekeeper(config)
if len(sys.argv) == 2 and sys.argv[1] == 'save':
    h.save()
elif len(sys.argv) == 3 and sys.argv[1] == 'track':
    h.track(sys.argv[2])
elif len(sys.argv) == 2 and sys.argv[1] == 'update':
    h.update()
elif len(sys.argv) == 2 and sys.argv[1] == 'link':
    h.link()
else:
    print_usage()
